  <link type="text/css" rel="stylesheet" href="/css/index.css">
  <link type="text/css" rel="stylesheet" href="/rickshaw/rickshaw.min.css">
  <script src="/rickshaw/vendor/d3.min.js"></script>
  <script src="/rickshaw/vendor/d3.layout.min.js"></script>
  <script src="/rickshaw/rickshaw.min.js"></script>
  <script>
var graph = new Rickshaw.Graph({
    element: document.querySelector("#graph"),
    renderer: "line",
    series: [
    {% for p in data %}
    {
        name: "{{ p.name }}",
        data: [
            {% for d in p.data %}
            { x: {{ d.date.strftime("%s") }}, y: {{ d.value }} },
            {% endfor %}
        ],
        color: "{{ p.color }}"
    },
    {% endfor %}
    ]
});
 
var legend = new Rickshaw.Graph.Legend({
    element: document.querySelector("#legend"),
    graph: graph
});

var x_axis = new Rickshaw.Graph.Axis.Time( { graph: graph } );
var y_axis = new Rickshaw.Graph.Axis.Y( {
        graph: graph,
        orientation: 'left',
        tickFormat: function (y) { return y + "%"; },
        element: document.getElementById('y_axis'),
} );

graph.render();

var hoverDetail = new Rickshaw.Graph.HoverDetail( {
	graph: graph,
	formatter: function(series, x, y) {
		var date = '<span class="date">' + new Date(x * 1000).toDateString() + '</span>';
		var swatch = '<span class="detail_swatch" style="background-color: ' + series.color + '"></span>';
		var content = swatch + series.name + ": " + y + '%<br>' + date;
		return content;
	}
} );

</script>

